## CAP理论
* C (一致性)：对某个指定的客户端来说，读操作能返回最新的写操作。
* A (可用性)：非故障的节点在合理的时间内返回合理的响应(不是错误和超时的响应)。可用性的两个关键一个是合理的时间，一个是合理的响应
* P (分区容错性)：当出现网络分区后，系统能够继续工作。打个比方，这里集群有多台机器，有台机器网络出现了问题，但是这个集群仍然可以正常工作
* 结论： 不可能同时满足三方, 只能满足其中两方来实现

## BASE理论
* BASE 是 Basically Available(基本可用)、Soft state(软状态)和 Eventually consistent (最终一致性)三个短语的缩写，是对 CAP 中 AP 的一个扩展
* 基本可用：分布式系统在出现故障时，允许损失部分可用功能，保证核心功能可用
* 软状态：允许系统中存在中间状态，这个状态不影响系统可用性，这里指的是 CAP 中的不一致
* 最终一致：最终一致是指经过一段时间后，所有节点数据都将会达到一致

## TCC理论
* TCC（Try-Confirm-Cancel）理论
    - 解决了协调者单点，由主业务方发起并完成这个业务活动。业务活动管理器也变成多点，引入集群
    - 同步阻塞：引入超时，超时后进行补偿，并且不会锁定整个资源，将资源转换为业务逻辑形式，粒度变小
    - 数据一致性，有了补偿机制之后，由业务活动管理器控制一致性
    - 解释：
        - Try 阶段：尝试执行，完成所有业务检查（一致性），预留必需业务资源（准隔离性）
        - Confirm 阶段：确认真正执行业务，不作任何业务检查，只使用 Try 阶段预留的业务资源，Confirm 操作满足幂等性。要求具备幂等设计，Confirm 失败后需要进行重试
        - Cancel 阶段：取消执行，释放 Try 阶段预留的业务资源，Cancel 操作满足幂等性。Cancel 阶段的异常和 Confirm 阶段异常处理方案基本上一致
    - 实现
        - 本地消息表[eBay方案](https://queue.acm.org/detail.cfm?id=1394128)
        - 华为的 Service Comb

## Saga理论
* Saga 是 30 年前一篇数据库伦理提到的一个概念。其核心思想是将长事务拆分为多个本地短事务，由 Saga 事务协调器协调，如果正常结束那就正常完成，如果某个步骤失败，则根据相反顺序一次调用补偿操作
* 相对于TCC理论

## 实践
* 2PC两段提交
    - 过程：准备-->提交
    - 实现2PC中间件代表：mycat、sharding-jdbc
    - 优点：实现简单
    - 缺点：数据库支持两段提交，单点问题、同步阻塞、数据有可能不一致
* AP理论实现者Zookepeer

## 开源项目
* [EasyTransaction](https://github.com/QNJR-GROUP/EasyTransaction)
* [seata](https://github.com/seata/seata)
